--beginvalidatingquery
	if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[sp_DatabaseVersion]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
    begin
		 select 1, 'Upgrading database'
    end
    else
		select -1, 'Not an EPiServer database'
--endvalidatingquery

-- Create MultivariateTest Tables to Store MultivariateTest Information.
DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Testing.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '1'

IF @CurrentMigration < '201705221805364_AddSiteLanguage'
BEGIN
    ALTER TABLE [dbo].[tblABTest] ADD [SiteLanguage] [nvarchar](max) NOT NULL DEFAULT ''
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'201705221805364_AddSiteLanguage', N'Testing.Migrations.Configuration',  0x1F8B0800000000000400ED5D4B6FE4B811BE07C87F10744A8259B73D73D918ED5D78FC58183B1E1BD39ED92097012DB1DBC44A54AF48796D2CF2CB72C84FCA5F48A95B0F3E448994E47677A6B187698BE44756B1AA587C54ED7FFFFD9FE98F4F71E43DE29491849EF8470787BE87699084842E4EFC8CCFBFFBDEFFF1873FFF697A11C64FDE97B2DEBBBC1EB4A4ECC47FE07C793C99B0E001C7881DC424481396CCF94190C413142693B787877F9F1C1D4D3040F880E579D34F19E524C6AB3FE0CFB3840678C933145D27218E58F11D4A662B54EF238A315BA2009FF817B764865318F1C1354A7FC51C067A7087D9EADF7314F9DE6944100C6B86A3B9EF214A138E380CFAF833C3339E2674315BC20714DD3D2F31D49BA388E18298E3BABA2D5D876F73BA2675C3122AC8184F6247C0A37705A3266AF35EECF62B46022B2F80E5FC39A77AC5CE131FB875FA3E679DEFA9BD1D9F45695EB393DD076BD4D5B41D54806FBCA2CA9B4A6440B2F2FFDE786759C4B3149F509CF114456FBCDBEC3E22C1CFF8F92EF915D3139A4591386E183994491FE0D36D9A2C71CA9F3FE17941CD55E87B13B9DD446D583513DAACC9FC2923F0FB23F48DEE235C49C5A4B5F91DE1112E1140B68060DFBB464F1F305DF087131F7EFADE2579C261F9A580FD4C09A81834E269869DBB3DC72C48C9722D15833B6FEFEBE6778AD3CD9378939205A128BAE2381E38493390E87A92C028E4629A8B6751E00E97F2730132FF7D07B6CC19E98286A3E0DCC2804840962BC5BDC5698029478B0AF78AF2776F9D413F20C641A9C99CE0F0FD738B001C1D1E8E2066174F4B1C701C7E218CF0243D4B607D50086807380DF2D5A3A5B923FDB022CD49082B21FE801F71544D5202C6CA7D8AFE390B92140F04B96233B2A0302301AAA97B9F241146D45D8C09C71F105D6482A46C4EBDCF520CD23E8EF89752DA0FEC237A248BB5E6C8B0B074802ECD931456C5005FD110D80EA2C57CEF138E560DD80359D616C550FFABB0C85EA649FC2989D62B6F67FDAF77285DE07CA2138746B3240303604FE61794121027235945B9910CADBC69D87AA5A6614E27B587D2E5B7181831A22363E8E15BF16C80C881100606AAA83B6F2804CDD8946528B5C7C932947AD957E50A251E51C50AC4BD4A597B00C3BDE11CA2E0F23007E98AFD42A8B037E8EB8880A3559C3EB081FED117827F6743895AC9177BC0E160BAFE0F2C97FBE2DF6099CC1E82C33841376B41F984199885364F4CADFB55B45FAAB16DA96CF0C1DA5AB83A606BC44BD8ECD280A0A89B36A56A2B69E6BA06CA5A1AF423EC0B8A32DC4D9450AD95A0E67A06620C9547F03D550118D7EF54D1BF9105F2E7251988D0B096F45B077EC164F1C007AE4720DEAB330D196C739B6CC11F1CC68D4271864ECE4E2C8895E579F9B5A5D98BB7598D06582EC5C08F6BB814F0BDDDB2DD1A00EFEB23461C9038FFF336855FC5B5DCF7BE370B500EE8AEBE2BF4F514165C7F8503BF955483FABF2CA97237AF46EDDE60BE80C3DA6C2E2D3CDC01D652F020C7B59402F0DE4A5A6B55940DBD43D96BE688BBAE668DECD8A2D9696316CBBA28DCD75EB1CB082DEA871BE3A865DE25936E8607EB252C22214EA3678010BD6F7902AF717C8FD352C5280A387904A2564C3CF10FB50997EA9FCAB58FDA6B9F27B4AEAB5FA8CAC869F000D06155FF9D3E73EB39123F9E3296802DCE67A1F3AA46385492C7714143AFCF59B874BF6FBC1FBA8699234B982B98F913FF6F1A171C7BAF0E1EA4DECBC332B9B3235F35CC37F41CF6881C7BF944E6CECF1962010A7535076E87F217B0E538C5347FC7044E0F03292494EB869FD0FC6140D4832405CB7219C9C75AF5AA969CE3250695A0BCC7FCDA0CA73C61D78754F5ACB0B58B8BD38920D29D92AE1F97B6C856CBD9A9244B95517692DC966BD95D915423099B914CE3FCEC8224761C53B49B3CAB330BD5DAEA27A2AE96D6EA18DE4635B6427AED08DA9891B598539BB108EEF32B8A76CB86B25DC46C7697AA606B0766AE726D7307B34B62DD4DCFC6A4BA7B3E7747A80D7BB176D9EADA98A9C22C9D67B80A72D7DDDB2E09713B2D1B13E0F6F9DB3EE15DEF98A10D8716F5C61271748F18CEBFE3A7A693B2CF50B8DE95B3E2485515B51C778679B9FD5C795CCCF7EAF301DD67D5C455C6303FE06C02356E183B7AA9DF4F36A1565AD081627CE16018AAEE6D5975A0BF3230E06B8B9E15BC7CD76F80964C90022B489D8ADDF5824E68EAF2F24E55999E870F153FDAC44ED3CF9E670D4267959EA8B652E6A41D971B5EFB3472B5639B6BBFD11508A9D5A89D4BE67DED4B71A5EBC6D72478D6FBAF9E3B30815EA3F5E894389B3D97C52CF5E66CDBD59089B1B6DE7F3FFF5F63AB6E333BB96AE1F1BF24534DA7FA2686DA789EEEBEA7C6487975E8646287B7398C81E5C543E5C95465D3C93AE2B4F8309D184253A7D768B924742184AA165FBCD93A4EF5ECBB997BCC66BCC69804AC2174B31A6DD5132C10688195D2FC1A3CC4972465BCF4CC7CEF2C8CB56AAADF6658E3CBDE64D74C9FBF72B92FEBE7BF8BE8AE8E8B18E34A5273F512088D73F739A719CBC2656AEBE5E1C3284269C34DE65912653135BBF2E6D645D0A708507CB2C79022384524A9C01EAF88D214918A4F0E184AC8A504A694D9A31697762258F1C909A30CB95470CACFF65855D0A588547DB4C731065D8AB8C64AF6FDA8719822BC5AE6C085C6704B89258D35EC7B688AC714F19BCAEDD1B5E84C115A2BB4C72DE33445B8F29B3D8A12A829991AB9C84107A4784D490DA412071E8A8F1824FE8905F678F2430611502ED111A713C5C86B0719DAE2A21D0DC96B95D54A66DCA98DBCB4998E167AAD75D6602FB4F815175BD2EA67B8EC32A3B484068AC02DD5F6626E2DE6957B3CB2581BF60976626C6CBCCD62DBE419B97B4452049E0A5515B8AC3665209EBCD0945F9D56D53A7C425951EB027BBC22204F442A3EB9502744E4C9040A057B73606D0E4C8745E32F7ADA2175DF05AF1BE865AC46F164555A92D69F5E4FA7CA602211AAFCE6E04D2AA149923FA99439EC89C48023691F241638D88FFA6E4BB221E62BAF9679D8EB7DE369E6F86AAFDE1DF5D5FA4E9CED55FA22C845F236D69F1C3194A81D0D502977354B753C8E6E99EAB2BEA88DC33654D91B8557340AD2C9FCF80641BCF1ED6B0C5A31B6D71014212BB2A0467A3AB4768CBDC03B0ABC76BDA356A97AAFAE7994EB9C6971B5D29D8E54BB6B5957C9631A934712E6F72CB367065BBB83BCC2C1ECB7E82C22383FFC2B2B5C234AE6A035EBD011FFEDE1D15B2589E9F624149D3016460D57538D5945E509DB40605A46C96F19CECF7E792E7CE9B0849EF411A5C1034AFF12A3A7BF8E91A4D308E89C8873D8D09A936B0E669E946893E4123E34B56608BFF908A9357BE374A4D6EC43647362CD7242F5D49A6E52D296475319AD0D9C39AB661FD20D3935E75182DCC1E4949AFD301A336ADE931E92DB904D73988E368498F696E2A610534BB0317232EEE03220A56AD3E1B4F7AD402C7E3AF1FF58B53FF6AEFEF1750DF1C6BB4961853FF60EBD7F8D9F40B18D4E1BEDDE41196B7E16BF97296B8B37EE92DF904DB0CFC2A0E612EC63821B723FF55B14A43482FDA8D19208F62268F7B4B3F3AC7E273455CA543118AD412EFB08959C44AC9F643727241BE6A7DCEA49C6FA90A7E5E5E865202B944136723715AFF5B8FC1BD43B29D154B8B99C5A03DDFEC63C59A30FBF354FD6300AF69A3C54938D67DDDFA0164B399F7AFA737B81B415C8F1F3F79481641BCF3A62135B375AD2A0BE81C8C6A087170A37B67C86AAF7FEDAF94C9C32EB6C87CC5561573DD3F9EC844C99DF806E9F0CF5CF89E336952F6AC6F4C0EF1132F10CCCD0F47A596CB63043C2B8396BB648F2B49400C333E5EC8CDC753F69DB56B173CF2AB3452227A58A1896CB666744ADFDB1D46B8B5973FE173DDC589D572D5B48E98DB5E577593FA4814DCD7D02D35F5C6BDDDBA67F69F3E79D12C01887D137658CA84DAD49638C3D0F4B2BE39055A68DF67172D0D8A7A0691BCBE07C3576E96ADA86B043796D64E553A2E8753362B795B60B53D416812D4A5433842D8A42AB616EA390BDF14C346E4459ED56BA637BC662D52653CB0C6694C128B644438CC5A64D248B19CC9E06436D781B6ECF16871430FA5B6070A1329A1FB4AEFF3AC78C2C6A882960521C48CE5355E78ACE93D28D53465456510F7A3147217856A72927731470280E3063ABFF9749919DFD22BEC7E115BDC9F832E340328EEF23292144EE0BB6F5BFCA73238F797AB37ABCCAC620018649F2B3E91BFA3E23519D55FEB2E16CDA00913B993F61F8BE9E4BF059395E3C57481F57C9ED6D800AF655BEF11D8E971180B11B3A4342367D87B17D66F8035EA0E0B97CD26D06E99E0899EDD3738216298A598151B7873F4186C3F8E987FF01BC8B39F9C7830000 , N'6.1.3-40302')
END


GO
