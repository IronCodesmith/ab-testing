--beginvalidatingquery
	if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[sp_DatabaseVersion]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
    begin
		 select 1, 'Upgrading database'
    end
    else
		select -1, 'Not an EPiServer database'
--endvalidatingquery

-- Create MultivariateTest Tables to Store MultivariateTest Information.
DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Testing.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '1'

IF @CurrentMigration < '201701172038001_FinancialResultsCulture'
BEGIN
ALTER TABLE [dbo].[tblABKeyFinancialResult] ADD [Culture] [nvarchar](max) NOT NULL DEFAULT ''
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'201701172038001_FinancialResultsCulture', N'Testing.Migrations.Configuration',  0x1F8B0800000000000400ED5DCD6EE4B811BE07C83B083A2581D76D7B2E1BA37B171EFF2C1A3B1E1B6E8F13E432A025769B5889EA1529AF8D204F96C33ED2BE424AAD3F92122552923DDDB1B1876DF3E7238B2C56154B559C3FFEFBFBF4C7A730701E71CC484467EEE1FE81EB60EA453EA1AB999BF0E577DFBB3FFEF0E73F4DCFFDF0C9B92BDA7D48DB414FCA66EE03E7EBE3C984790F38446C3F245E1CB168C9F7BD289C203F9A1C1D1CFC7D727838C100E10296E34C6F12CA4988377FC09FA711F5F09A2728B88C7C1CB0BC1C6A161B54E7330A315B230FCFDCF36BB2C031CC78FF12C5BF600E13DDBFC56CF3FF3314B8CE4940104C6B8183A5EB204A238E384CFAF80BC30B1E4774B55843010A6E9FD718DA2D51C0704ECC71D5DC94AE83A394AE49D5B180F212C6A3D012F0F043BE5013B57BAFE576CB8584A53C8725E7CF29D59BE59CB9B05A271FD3A5731D75B4E3D3204E5B762EF77E86BAD9B6FD1270CFC99BEC952C039C95FEB7E79C26014F623CA338E1310AF69CEBE43E20DECFF8F936FA05D3194D82409C37CC1CEAA40228BA8EA3358EF9F30D5EE6D4CC7DD799C8FD266AC7B29BD02723F3A784C0EFCF3036BA0F70C91593D6EEB78407B84000DE02825DE7123D7DC274C51F662EFC749D0BF284FDA22487FD42091C31E8C4E3045B0F7B8699179375C61583076F1FEBEA378AE3D727F12A262B425130E7381CB8490BE0E86A934028A46C9AB2675E610F17F3330132FD7D0BB2CC1AE99CFAA3E05CC3848847D69B837B8D630F538E5625EE9CF20F47D6A09F10E370A8C99260FFE3730B031C1E1C8CC066E74F6BEC71ECDF114678149F46A01F1402DA014EBC547BB474B7A41F34D292F8A009F127FC88837293221056F65BF4AF8517C57820C89C2DC88AC28E78A8A2EE63140518517BFA620CFC360E03167CD20FEC337A24AB8C77655810DEC0CDCB2806BDE4E139F58170D85CE63A3738D874600F645D9D694DFBAF829ABB88A3F0260A32DDD7D9FEEB2D8A57385DEAC8A2D3224AE0089A93798762021BAA252BAFD79251AB6F9A76BD51D334A793CA46E8B21C340B31A229A119E1ADD81640E44008CD02AAA83B2F288493F15A92A1383D5692A138977D8F5C7E88473C6239E2FB9132D6C1C3EDD114225FE56126CA9CFD8350C13AEF6D0A4434BFFFB36113BA23F8B7811073B6612FF680FD3760E1740A2E7BDDDF2098F40682C53CE1685EC0858C7A04053798815068B3C394A65F45E1A54A5A7D5B8DFDD5D2C1D6F6CA00EF5090E06EA28466AD0435B7D310A3693C8275A62CD3B8869902FE4614C8CF6B325405C1DA579749EC9130FDF33A865FB903F67BD759782805EC218033EE1938C77CC35EDFE9B31B12BB3CF72F2DFD9A6D4C037139406808E2685C812100BF0B0BE3E31C24439D46238984FF9393395085379FC80E7D6F761A93503E8B82837ACE2E02B4AABE548D732CD32199E40A1F7C2E41FCFB380E9E0142BC03C81B7889C37B1C17478C228F9347206AB38833F7A0B6E152FB13B9F5617BEBB388566DEB1E641939F61E00DA2FDB7FA8EF5CB64762E1096311C8E274173A3D6382112FCFE39CFA4E1FD783F44143EB8EBB849D236BD82BD8F999FBB7DA2A588E5E5AB1D2E8C5E5441EECD05505F3153DC301E6D849373235774E11F3905F3FE6B0DABE5C02B21CC798A61F6EE1C2CA800B09E575C14F68FA2524E841928265A846D2B996A3AA3567788DE14850DE637F4DA6533834EA532A475696B56B15A71381A53B39BD7E3D6DE1AD96BBAAC44BA550B6E2DC162FF8AE70AA9684D7E14CEDFEEC0227B65BDDED12CFC40457656DED726D2B664DBC1E26C7622B38D7889E5793AFDDFB693215C170FE864CAD3158DB79ABCB7A559959BAF4D9327297B76B9798B89D965763E0F6FDDB3EE6CDAE15D087438FCAFA461CDD2386D372FCD4E44EF80295D9D585E51E2395D552DC05E6858DBE514BCC75AA4B545DB1D7D855C6D0071534816AADEA8E51AA6FFA4DA8E529E840D1B9DD3533ADE9242378D9F9AD81962484022B30858ADDF5D155E86AF3B156E5E89E17A8723DDAB8A2767C7ADE9784C14A36564599BC9266ABDCF085A871553B4C7573635D20A4E2F2F655D2DBE62FB52A1D4E581DDF999A90FD8C488158DDC9EEE43603B3D160837A2FAACE7FA65B5013F3C5DE80A92DA42CC33A17B1C36419B680858BAF548765DD749205B3E705D38926EA7D7A89D66B425742147C5EE22CB210F8D3EF16F6E1E0618631F15843547839DB72241063688595DA3458C0C7172466BC50EFAE73EA87B566AAF2D768A2623459BFD7F7AF504A45FBF4771E38DAE1F2D4CABB6A552F80D030B5C1529AB1CC5CBABE4E9A99800214377C33388D8224A47A7B50DF3B8F271701F222730C29385C44922ACCF1F2007011292FB2C050A2B92530A5CE1C35778F8B607991154611CDADE014C5E658653CB78854169AE368E3B9455C6D23F371D4106F115EADB35885C6486E69491A5B988FD014EA2DE237D59BA3D702BF45E85AA5396E11022EC21565E6284A0CB8246AE42A0B8AC58F7B12B56285399EFC814F04946BEA88D38922926B77D79A2AA8790364CD62A477B4D6FFC88A48779BECA5998CC15E4855E50E5F4957699CC07A9496086511B8A5D93B9B1BB37969CC8ECCD61AABDE8C8DB59DB7996D9BEC187BFB450A0456A1CA0A1BDD50C403CB6AA128B5D2815544B0A2FFAA0A73BC3C305844CA8B6CA81322836502858A7771602C0E343E88F1759EEA97ECABEE3A715E4664E4715C923ECA8A2CC44E16F629499DACC8E210553E7DE920E95DFD7AAC32C45362FCA2F0FD10591E22C9FF34FE0112BDEF7D0F4F2BC6F61E9C3C045266F8A09E4FDC8E31E2C1791B0C5F7362AA4DCAD14B67A6E2B49CE60EC4EEF73C6A1EC5AC491A151F3DC2653B9EB98B670626D17EDA607FF16B701A109C5E718B069708AEBD706AB25044F7E8E0F0487905647B5EE49830E6070D0ED8C66739E40D7B8540E784925F139C7A3878CA7CF1B01731E8238ABD0714FF25444F7F1DE3950B2DA0F54B16C3A6D6FC3AC5E0C5935EAA2029870F7D9BC287DF7C84B7297AE374BC4DD187C8E697298A0DADBF4D61C7256D0F5128B33581D33F4BD18774CDA314CB2042F660F29B14FD301A9FA4B8273D28AB2718F4E6B9A6040343B0311E40D841A12DE545D7E16A813B402C7E9AB9FFDEF43F76E6FFFC9A41EC395731E8E363E7C0F9CFF8AF15B4D16972167790C79AE3FDDE79CA583E8DABA01B52F7FB88713571BF97C0AC27EDF7998A94B2DF8F965AC2FEDB91FFAD1EA99D38A65292E2F0432F6637FB2F9EDDDC4BAA942883048B92233DEC3AB19BCCAFF528BD41C6973275FB99D25BC5DDDBCD90E3675D16A1B3AF9E2B66124D3C5AAA67DFCC086D00DD2B2648EE44169A553EE476F05C19C2DB33097327784A1FA1B07D3CD43B93D16E275F548AD5325186E74F0E4CAAFD66D9875B98AE355EAEE116B19C94A1342CC3716758ADFDBBF0B766B3E6ACC07AFE80BAAFB524B54225B665FD65DF0CC1B2BC8F60FB739FE0BD6952609B51659516A89D46DF4442F134B5A6126A471E946C689E6BD846F9E0C444B3BCC4B629EC5002A3CCEE4A224ABF7CC4869429236EDCA68CC421CBA21C2135F67417530EED4832B1D13AE3ED76298970F0F234481F4D34D58BA406D6A36740130BFF660E58048CAC2A88F45FD0A1D8937470D9664E9751610D28332A9AA84E1BCC910F0AFA24E664893C0ED51E666CF30E64FE3ED679788FFD39BD4AF83AE140320EEF032951283529DAC6DFE43FCA739E5E6DC23DD81824C03449EA67BAA21F131254EF7A5D34F8993410A9ADF21386F26C2FC1F4E178F55C227DDE3C2F6602942F5F6962DDE2701D0018BBA20B24BC676631B72F0C7FC22BE43D1741507A90EE8D90977D7A46D02A4621CB31AAFEF027F0B01F3EFDF03FB3AF16243A6A0000 , N'6.1.3-40302')
END


